#!/bin/sh
# Pre-commit hook to block common sensitive files from being committed (checks staged files)
# Install by running the setup script which sets `git config core.hooksPath .githooks`

for file in $(git diff --cached --name-only -z | xargs -0 -n1); do
  case "$file" in
    *.env|*.env.*|*.key|*.pem|*.crt|*.p12|*.jks|secrets/*|credentials/*|uploads/*|node_modules/*|dist/*|*.log)
      echo "ERROR: Attempt to commit a protected file: $file"
      echo "Remove it from the commit or add an explicit ignore entry if appropriate."
      exit 1
      ;;
  esac
done

exit 0
